{{- if (and (not .Site.Params.disableThemeToggle) (not (or (eq .Site.Params.defaultTheme "light") (eq .Site.Params.defaultTheme "dark")))) }}
<script>
    // load memory
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else {
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.body.classList.add('dark');
        }
    }
</script>
{{- end }}
{{- if (and (.Site.Params.disableThemeToggle) (eq .Site.Params.defaultTheme "auto")) }}
<script>
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>
{{- end }}
<noscript>
    <style type="text/css">
        .theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<header class="header">
    <nav class="nav">
        <p class="logo">
            <a href="{{ "" | absLangURL }}">
                {{- if .Site.Params.label.icon }}
                <img src="{{- .Site.Params.label.icon -}}" alt="logo" aria-label="logo"
                    height="{{- .Site.Params.label.iconHeight | default "30px" -}}">
                {{- end -}}
                {{- .Site.Params.label.text | default .Site.Title -}}
            </a>
            {{- if (and (not .Site.Params.disableThemeToggle) (not (or (eq .Site.Params.defaultTheme "light") (eq .Site.Params.defaultTheme "dark")))) }}
            <span class="theme-toggle">
                <a id="theme-toggle">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </a>
            </span>
            {{- end}}
        </p>
        {{- $currentPage := . }}
        <ul class="menu" id="menu" onscroll="menu_on_scroll()">
            {{- range .Site.Menus.main }}
            {{- $menu_item_url := .URL | relLangURL }}
            {{- $page_url:= $currentPage.RelPermalink | relLangURL }}
            <li>
                <a href="{{ .URL | absLangURL }}">
                    <span {{- if eq $menu_item_url $page_url }}
                        {{- /* the menu item links to the current page (with relLangURL) */}} class="active" {{- end }}>
                        {{ .Name }}
                    </span>
                </a>
            </li>
            {{- end -}}

            {{ $lang := .Lang}}
            <ul class="lang-switch">
                <span>|&nbsp;</span>
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor" stroke="currentColor"
                    stroke-width="0.8">
                    <g>
                        <path
                            d="m17,20l-14.5,0c-1.378,0 -2.5,-1.122 -2.5,-2.5l0,-15c0,-1.378 1.122,-2.5 2.5,-2.5l8,0a0.5,0.5 0 0 1 0.473,0.338l6.5,19a0.5,0.5 0 0 1 -0.473,0.662zm-14.5,-19a1.5,1.5 0 0 0 -1.5,1.5l0,15a1.5,1.5 0 0 0 1.5,1.5l13.8,0l-6.157,-18l-7.643,0z" />
                        <path
                            d="m21.5,24l-8,0a0.5,0.5 0 0 1 -0.468,-0.324l-1.5,-4a0.5,0.5 0 0 1 0.936,-0.352l1.379,3.676l7.653,0a1.5,1.5 0 0 0 1.5,-1.5l0,-15a1.5,1.5 0 0 0 -1.5,-1.5l-9.5,0a0.5,0.5 0 1 1 0,-1l9.5,0c1.378,0 2.5,1.122 2.5,2.5l0,15c0,1.378 -1.122,2.5 -2.5,2.5z" />
                        <path
                            d="m13.5,24a0.5,0.5 0 0 1 -0.376,-0.83l3.5,-4a0.5,0.5 0 1 1 0.753,0.659l-3.5,4a0.5,0.5 0 0 1 -0.377,0.171zm-4,-10a0.5,0.5 0 0 1 -0.471,-0.332l-2.029,-5.681l-2.03,5.68a0.5,0.5 0 1 1 -0.942,-0.336l2.5,-7c0.142,-0.398 0.8,-0.398 0.94,0l2.5,7a0.5,0.5 0 0 1 -0.303,0.639a0.48,0.48 0 0 1 -0.165,0.03z" />
                        <path
                            d="m8,11l-2,0a0.5,0.5 0 1 1 0,-1l2,0a0.5,0.5 0 1 1 0,1zm13.5,0l-7,0a0.5,0.5 0 1 1 0,-1l7,0a0.5,0.5 0 1 1 0,1z" />
                        <path
                            d="m17.5,11a0.5,0.5 0 0 1 -0.5,-0.5l0,-1a0.5,0.5 0 1 1 1,0l0,1a0.5,0.5 0 0 1 -0.5,0.5zm-1.5,6a0.5,0.5 0 0 1 -0.29,-0.907c2.2,-1.555 3.8,-4.727 3.8,-5.592a0.5,0.5 0 1 1 1,0c0,1.318 -1.927,4.785 -4.2,6.408c-0.088,0.06 -0.2,0.1 -0.3,0.1l-0.01,-0.009z" />
                        <path
                            d="m20,18c-0.12,0 -0.242,-0.043 -0.337,-0.13c-0.363,-0.332 -3.558,-3.283 -4.126,-4.68a0.5,0.5 0 0 1 0.275,-0.651a0.5,0.5 0 0 1 0.651,0.275c0.41,1.007 2.936,3.46 3.875,4.32a0.5,0.5 0 0 1 -0.338,0.866z" />
                    </g>
                </svg>
                {{- range $.Site.Home.AllTranslations -}}
                {{ if ne $lang .Lang }}
                <li>
                    <a href="{{- .Permalink -}}"
                        title="{{ .Language.LanguageName | default .Lang | humanize}}">{{- .Lang | humanize -}}</a>
                </li>
                {{- end -}}
                {{end}}
                </span>
            </ul>
        </ul>
    </nav>
</header>
